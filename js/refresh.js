function refreshCacheAndDeleteCookies(){if(confirm("是否清除所有缓存、删除第三方Cookie并重新加载页面？")){const o=document.getElementById("refresh-btn");o&&(o.disabled=!0,o.textContent="正在清理数据..."),(async()=>{try{if(console.log("--- 开始清理 Cache API 缓存 ---"),"caches"in window){const o=await caches.keys();console.log(`找到 ${o.length} 个缓存，准备删除...`,o),o.length>0?(await Promise.all(o.map(o=>caches.delete(o))),console.log("所有 Cache API 缓存已成功删除。")):console.log("没有找到 Cache API 缓存。")}else console.warn("当前浏览器不支持 Cache API，跳过缓存清理。");if(console.log("--- Cache API 缓存清理完成 ---"),console.log("--- 开始删除第三方 Cookie ---"),"cookieStore"in window){const o=window.location.hostname;console.log(`当前第一方域名: ${o}`);const e=await cookieStore.getAll();let n=0;for(const t of e)t.domain&&t.domain!==o&&!o.endsWith(t.domain)&&(console.log(`找到第三方 Cookie: ${t.name} (域: ${t.domain})，准备删除...`),await cookieStore.delete(t.name,{domain:t.domain,path:t.path}),n++);n>0?console.log(`成功删除了 ${n} 个第三方 Cookie。`):console.log("没有找到第三方 Cookie。")}else console.warn("当前浏览器不支持 Cookie Store API，无法自动删除 Cookie。请手动在浏览器设置中清除。");console.log("--- 第三方 Cookie 删除完成 ---"),console.log("所有清理任务完成，即将强制重新加载页面..."),window.location.reload(!0)}catch(e){console.error("执行清理任务时出错:",e),console.error("清理失败，请查看控制台获取详细信息。"),o&&(o.disabled=!1,o.textContent="清除所有缓存")}})()}}document.addEventListener("click",function(o){o.target&&"refresh-btn"===o.target.id&&refreshCacheAndDeleteCookies()}),window.refreshCache=refreshCacheAndDeleteCookies;