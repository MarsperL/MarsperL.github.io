!function(){var e=!1,t="Engagement",n="Like";function o(e){var t=document.createElement("div");t.innerText=e,t.style.position="fixed",t.style.top="20%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(0, 0, 0, 0.85)",t.style.color="white",t.style.padding="15px 30px",t.style.borderRadius="8px",t.style.zIndex="1000",t.style.fontSize="16px",t.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.2)",document.body.appendChild(t),setTimeout(function(){document.body.removeChild(t)},1800)}function i(e){var t=function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].trim();if(o.startsWith(e+"="))return o.substring(e.length+1)}return null}("likes_"+e);return t?parseInt(t):0}function r(e,t){!function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="expires="+o.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"}("likes_"+e,t,30)}function a(){e&&"function"==typeof window.gtag&&gtag("event",n||"Like",{event_category:t||"Engagement",event_label:window.url})}!function(){var e={enable:!0,Backend:"Cloudflare",CloudflareBackend:"nyyg.qzz.io",PHPBackend:"",AppID:"",AppKEY:"",xianzhi:!1,number:5,GoogleAnalytics:!1,GAEventCategory:"Engagement",GAEventAction:"Like"},t=location.host+location.pathname;function n(n){var a=e.CloudflareBackend?"https://"+e.CloudflareBackend.replace(/^https?:\/\//,"").replace(/\/$/,"")+"/like":null;if(!a)return o("Cloudflare Workers 后端未配置"),void console.error("Cloudflare后端地址未配置！");var l={Url:t,Add:n?1:0};fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(function(e){if(429===e.status)throw o("您已达到速率限制"),new Error("429");return e.json()}).then(function(e){if(void 0!==e.likes){if(l=e.likes,(d=document.getElementById("zan_text"))&&(d.innerHTML=l),n){var a=i(t);r(t,a+1),o("点赞成功")}}else o("获取点赞数失败");var l,d}).catch(function(e){e&&"429"===e.message||(o("后端请求失败, 请检查Cloudflare配置"),console.error("Cloudflare 请求失败：",e))})}function l(e){n(e)}window.flag=0,window.url=t,window.goodplus=function(n,r){var d;if(e.xianzhi&&i(t)>=e.number)return void o("最多只能点 "+e.number+" 个赞");a(),l(!0),(d=document.querySelector(".heart"))&&(d.classList.remove("heartAnimation"),d.offsetWidth,d.classList.add("heartAnimation"),setTimeout(function(){d.classList.remove("heartAnimation")},800))},document.addEventListener("DOMContentLoaded",function(){l(!1)})}()}();