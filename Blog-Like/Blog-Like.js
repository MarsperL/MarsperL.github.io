!function(){var e=!1,n="Engagement",t="Like";function o(e){var n=document.createElement("div");n.innerText=e,n.style.position="fixed",n.style.top="20%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.backgroundColor="rgba(0, 0, 0, 0.85)",n.style.color="white",n.style.padding="15px 30px",n.style.borderRadius="8px",n.style.zIndex="1000",n.style.fontSize="16px",n.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.2)",document.body.appendChild(n),setTimeout(function(){document.body.removeChild(n)},1800)}function i(e){var n=function(e){for(var n=document.cookie.split(";"),t=0;t<n.length;t++){var o=n[t].trim();if(o.startsWith(e+"="))return o.substring(e.length+1)}return null}("likes_"+e);return n?parseInt(n):0}function r(e,n){!function(e,n,t){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var i="expires="+o.toUTCString();document.cookie=e+"="+n+";"+i+";path=/"}("likes_"+e,n,30)}function a(){e&&"function"==typeof window.gtag&&gtag("event",t||"Like",{event_category:n||"Engagement",event_label:window.url})}!function(){var e={enable:!0,Backend:"Cloudflare",CloudflareBackend:"nyyg.indevs.in",PHPBackend:"",AppID:"",AppKEY:"",xianzhi:!1,number:5,GoogleAnalytics:!1,GAEventCategory:"Engagement",GAEventAction:"Like"},n=location.host+location.pathname;function t(t){var a=e.CloudflareBackend?"https://"+e.CloudflareBackend.replace(/^https?:\/\//,"").replace(/\/$/,"")+"/like":null;if(!a)return o("Cloudflare Workers 后端未配置"),void console.error("Cloudflare后端地址未配置！");var l={Url:n,Add:t?1:0};fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(function(e){if(429===e.status)throw o("您已达到速率限制"),new Error("429");return e.json()}).then(function(e){if(void 0!==e.likes){if(l=e.likes,(d=document.getElementById("zan_text"))&&(d.innerHTML=l),t){var a=i(n);r(n,a+1),o("点赞成功")}}else o("获取点赞数失败");var l,d}).catch(function(e){e&&"429"===e.message||(o("后端请求失败, 请检查Cloudflare配置"),console.error("Cloudflare 请求失败：",e))})}function l(e){t(e)}window.flag=0,window.url=n,window.goodplus=function(t,r){var d;if(e.xianzhi&&i(n)>=e.number)return void o("最多只能点 "+e.number+" 个赞");a(),l(!0),(d=document.querySelector(".heart"))&&(d.classList.remove("heartAnimation"),d.offsetWidth,d.classList.add("heartAnimation"),setTimeout(function(){d.classList.remove("heartAnimation")},800))},document.addEventListener("DOMContentLoaded",function(){l(!1)})}()}();