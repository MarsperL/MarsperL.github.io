window.onload=function(){};var fn={byID:function(t){return document.getElementById(t)},byTag:function(t){return document.getElementsByTagName(t)},byClass:function(t){return document.getElementsByClassName(t)}},audio=function(t,e,s){this.obj=document.createElement("AUDIO"),this.obj_s1=document.createElement("SOURCE"),this.obj_s3=document.createElement("SOURCE"),this.obj.innerHTML="您的浏览器等级太低，不支持音乐播放器，建议更换其他浏览器",this.pl=t,this.lo=e,this.vo=arguments[2]?arguments[2]:.5};audio.prototype.play=function(t){this.src_mp3="mp3/"+t+".mp3",this.src_wav="mp3/"+t+".wav",this.obj_s1.setAttribute("src",this.src_mp3),this.obj_s1.setAttribute("type","audio/mpeg"),this.obj_s3.setAttribute("src",this.src_wav),this.obj_s3.setAttribute("type","audio/wav"),this.obj.appendChild(this.obj_s1),this.obj.appendChild(this.obj_s3),this.obj.autoplay=this.pl,this.obj.volume=this.vo,this.obj.loop=this.lo,this.obj.play()},audio.prototype.pause=function(){this.obj.pause()};var sound_complete=new audio(!0,!1,.8),background_music=new audio(!0,!0,.8),isusing=!1,newMessageRemind={_step:0,_title:document.title,_timer:null,show:function(){newMessageRemind._title.replace("【　　　】","").replace("【新消息】","");return newMessageRemind._timer=setTimeout(function(){newMessageRemind.show(),newMessageRemind._step++,3==newMessageRemind._step&&(newMessageRemind._step=1),1==newMessageRemind._step&&(document.title="【　　　】时钟完成"),2==newMessageRemind._step&&(document.title="【番茄熟了】时钟完成")},800),[newMessageRemind._timer,newMessageRemind._title]},clear:function(){clearTimeout(newMessageRemind._timer),document.title=newMessageRemind._title}};function newMessage(){isusing||(isusing=!0,newMessageRemind.show())}document.onclick=function(){isusing=!1,newMessageRemind.clear()};var tomato=function(t,e,s,i,o){this.el=fn.byID(t),this.start_bt=fn.byID(e),this.progress_bar=fn.byID(s),this.time=i,this.i=0,this.m=0,this.s=0,this.t,this.total_s=60,this.rest=o,this.breakoff=!1};tomato.prototype.start=function(){if(0==this.if_rest&&todo.p_bgm(),1==this.breakoff)return clearTimeout(this.t),this.el.innerHTML="00:00",this.start_bt.disabled=!1,this.start_bt.innerHTML="开始新的番茄",this.progress_bar.style.width=0,this.i=0,this.m=0,todo.breakoff=!1,todo_rest.breakoff=!1,background_music.pause(),void(background_music=null);if(0==this.if_rest?this.start_bt.innerHTML="正在执行":this.start_bt.innerHTML="休息中",this.start_bt.disabled="disabled",0==this.if_rest&&null!=localStorage.getItem("time")&&this.i<=0&&(this.time=localStorage.getItem("time")),1==this.if_rest&&null!=localStorage.getItem("restTime")&&this.i<=0&&(this.time=localStorage.getItem("restTime")),this.i++,this.s=this.i%60,this.total_s-this.s==59&&this.m++,this.time-this.m<10)var t="0"+(this.time-this.m);else t=this.time-this.m;if(this.total_s-this.s<10)var e="0"+(this.total_s-this.s);else e=this.total_s-this.s;0==this.s&&(e="00"),this.el.innerHTML=t+":"+e,1==this.if_rest?document.title="休息中"+t+":"+e:document.title="工作中"+t+":"+e,this.progress_bar.style.width=240-1e3*this.i/(6e4*this.time)*240+"px";var s=this;this.t=window.setTimeout(function(){s.start()},1e3),this.time-this.m<0&&(this.el.innerHTML="00:00",newMessage(),clearTimeout(this.t),this.start_bt.disabled=!1,this.start_bt.innerHTML="开始新的专注",this.i=0,this.m=0,background_music.pause(),background_music=null,this.remind())},tomato.prototype.if_rest=function(t){return this.if_rest=t,this.if_rest},tomato.prototype.remind=function(){if(0==this.if_rest){var t=0;this.t=function(){t++,todo.p_wt(),t>=6&&clearInterval(e)};var e=window.setInterval(this.t,1e3)}document.title="您完成了一个番茄";setTimeout(function(){a_m.showTime()},1e3);document.title="开始休息",0==this.if_rest&&todo_rest.start()},tomato.prototype.p_bgm=function(){var t="时针走动";null!=localStorage.getItem("background_music")&&(t=localStorage.getItem("background_music")),null==background_music?(background_music=new audio(!0,!0,.5)).play(t):background_music.play(t)},tomato.prototype.p_wt=function(){var t="女声";null!=localStorage.getItem("warningTone")&&(t=localStorage.getItem("warningTone")),sound_complete.play(t)};var todo=new tomato("tomato","start","progress_bar",25);todo.if_rest(!1);var todo_rest=new tomato("tomato","start","progress_bar",5);todo_rest.if_rest(!0);var win=function(t,e){this.win_obj=fn.byID(t),this.bt=fn.byID(e)};win.prototype.show_hidden=function(){var t=this;this.bt.addEventListener("click",function(){"block"==t.win_obj.style.display?t.win_obj.style.display="none":t.win_obj.style.display="block"})},win.prototype.tab=function(t,e,s,i){for(var o=fn.byClass(t)[0].getElementsByTagName(e),n=fn.byClass(s)[0].getElementsByTagName(i),a=0;a<o.length;a++)o[a].index=a,o[a].onclick=function(t){for(var e=0;e<n.length;e++)n[e].style.display="none",o[e].className="";n[this.index].style.display="block",this.className="tab_select",t.stopPropagation()}};var win_bottom=new win("alert_window","menu");win_bottom.show_hidden(),win_bottom.tab("set_menu","li","set_list","ul");var s_t=fn.byID("s_t");s_t.onchange=function(){localStorage.setItem("time",s_t.value)};var s_r_t=fn.byID("s_r_t");s_r_t.onblur=function(){localStorage.setItem("restTime",s_r_t.value)};var c_t=fn.byID("close_tomato");c_t.onclick=function(){confirm("确定终止当前番茄吗")&&(todo.breakoff=!0,todo_rest.breakoff=!0)};var w_t=fn.byID("w_t");w_t.onchange=function(){localStorage.setItem("warningTone",w_t.value),sound_complete.pause(),sound_complete=null,sound_complete=new audio(!0,!1,.8)};var b_m=fn.byID("b_m");b_m.onchange=function(){localStorage.setItem("background_music",b_m.value),background_music.pause(),background_music=null,background_music=new audio(!0,!0,1)};var alert_message=function(){this.bg=fn.byClass("remind_alert")[0],this.con=fn.byClass("remind_content")[0]};alert_message.prototype.showTime=function(){this.bg.style.display="block",this.con.style.display="block",this.dis=function(){t.bg.style.display="none",t.con.style.display="none"};var t=this;this.t=setTimeout(t.dis,2e3)};var a_m=new alert_message;