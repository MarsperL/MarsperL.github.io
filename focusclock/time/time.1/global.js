function getByClassName(e,n){for(var i=e.getElementsByTagName("*"),t=new Array,s=0;s<i.length;s++)i[s].className==n&&t.push(i[s]);return t}function getStyle(e,n){return e.currentStyle?e.currentStyle[n]:getComputedStyle(e,null)[n]}function startMove(e,n,i){var t=!0;clearInterval(e.timer),e.timer=setInterval(function(){flag=!0;var s=0,o=null;for(var a in n){if("opacity"==a){var l=!0;o=Math.round(100*parseFloat(getStyle(e,a)))}else o=parseInt(getStyle(e,a));s=(s=(n[a]-o)/8)>0?Math.ceil(s):Math.floor(s),o!=n[a]&&(t=!1),l?(e.style.filter="alpha(opacity:"+(o+s)+")",e.style[a]=(o+s)/100):e.style[a]=o+s+"px",t&&(clearInterval(e.timer),i&&i())}},30)}window.onload=function(){windowOnTop=!0,finishAutoRest=!1,clockTime=1500,clockSRestTime=300,clockLRestTime=15,lRestInterval=4,soundRemind=!0,tick=!1,soundTick="time/media/audio_tick.mp3",soundMission="time/media/audio_work.mp3",soundMissionDef=soundMission,soundRest="time/media/audio_rest.mp3",soundRestDef=soundRest,position=null,miniBlack=!1,desktopRemind=!0,manualOperation=!1;for(var e=document.getElementById("nav").getElementsByTagName("a"),n=document.getElementById("panle"),i=new Array,t=0;t<n.childNodes.length;t++)1==n.childNodes[t].nodeType&1!=t&&i.push(n.childNodes[t]);for(t=0;t<e.length;t++)e[t].index=t,e[t].onclick=function(){for(var n=0;n<e.length;n++)e[n].className="",this.className="on",i[n].className="hidden",i[this.index].className=""};var s=document.getElementById("set").getElementsByClassName("button"),o=document.getElementById("menu-set"),a=new Array;for(t=0;t<o.childNodes.length;t++)1==o.childNodes[t].nodeType&&a.push(o.childNodes[t]);for(t=0;t<s.length;t++)s[t].index=t,s[t].onclick=function(){for(var e=0;e<s.length;e++)s[e].className="button",this.className="button on",a[e].className="hidden",a[this.index].className=""};function l(e,n){this.index=e,this.obj=n,this.obj.offsetLeft,this.obj.style.left}l.prototype={constructor:l,Console:function(){},Initialize:function(){switch(this.index){case 0:windowOnTop?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px";break;case 1:finishAutoRest?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px";break;case 2:soundRemind?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px";break;case 3:tick?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px";break;case 4:miniBlack?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px";break;case 5:desktopRemind?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px";break;case 6:manualOperation?d[this.index].obj.style.left="0px":d[this.index].obj.style.left="-50px"}},Set:function(){switch(this.index){case 0:this.obj.offsetLeft>=0?windowOnTop=!1:windowOnTop=!0;break;case 1:this.obj.offsetLeft>=0?finishAutoRest=!1:manualOperation?(alert("不可与[手动模式]同时打开！"),startMove(r[this.index],{left:-50})):finishAutoRest=!0;break;case 2:this.obj.offsetLeft>=0?soundRemind=!1:soundRemind=!0;break;case 3:this.obj.offsetLeft>=0?tick=!1:tick=!0;break;case 4:this.obj.offsetLeft>=0?miniBlack=!1:miniBlack=!0;break;case 5:this.obj.offsetLeft>=0?desktopRemind=!1:desktopRemind=!0;break;case 6:this.obj.offsetLeft>=0?manualOperation=!1:finishAutoRest?(alert("不可与[点击完成时自动休息]同时打开！"),startMove(r[this.index],{left:-50})):manualOperation=!0}}};var m=n.getElementsByClassName("radio"),r=n.getElementsByClassName("radio-ul"),d=new Array;for(t=0;t<r.length;t++)d.push(new l(t,r[t])),d[t].Initialize();for(t=0;t<m.length;t++)(function(e){m[e].index=e,m[e].onclick=function(){d[e].Console(),r[this.index].offsetLeft>=0?startMove(r[this.index],{left:-50}):startMove(r[this.index],{left:0}),d[e].Set()}})(t);var c=document.getElementById("sound").getElementsByTagName("ul")[1],p=new Array,u=new Array,h=new Array;for(t=0;t<2;t++)p.push(c.getElementsByClassName("filename")[t]),u.push(c.getElementsByClassName("file")[t]),h.push(c.getElementsByClassName("button-default")[t]);for(t=0;t<u.length;t++)(function(e){u[e].onchange=function(){p[e].innerHTML=u[e].value,0==e?soundMission=u[e].value:soundRest=u[e].value},h[e].onclick=function(){0==e?(p[e].innerHTML=soundMissionDef.slice(8),u[e].value="",soundMission=soundMissionDef):(p[e].innerHTML=soundRestDef.slice(8),u[e].value="",soundRest=soundRestDef)}})(t);var T=document.getElementById("base").getElementsByTagName("ul")[1],f=new Array;for(t=0;t<T.childNodes.length;t++)t>=5&&1==T.childNodes[t].nodeType&&f.push(T.childNodes[t].getElementsByTagName("input")[0]);for(t=0;t<f.length;t++)(function(e){f[e].onchange=function(){switch(e){case 0:clockTime=60*f[e].value;break;case 1:clockSRestTime=60*f[e].value;break;case 2:clockLRestTime=60*f[e].value;break;case 3:lRestInterval=60*f[e].value}}})(t);var y,g,k=document.getElementById("addMission"),S=(document.getElementById("addMission-nav-close"),document.getElementsByTagName("strong")[0]),M=document.getElementById("addMission-foot-button-confirm"),L=document.getElementById("missionName");document.getElementById("addMission-main-button-sub").onclick=function(){parseInt(S.innerHTML)>1&&(S.innerHTML=parseInt(S.innerHTML)-1)},document.getElementById("addMission-main-button-add").onclick=function(){S.innerHTML=parseInt(S.innerHTML)+1},k.onclick=function(e){var n=(e=e||window.event).target||e.srcElement;if("addMission-nav-close"==n.id||"addMission-foot-button-cancel"==n.id)return k.className="noClick",S.innerHTML=1,void(L.value="");if("addMission-main-button-sub"!=n.id&&"addMission-main-button-add"!=n.id&&"addMission-foot-button-confirm"!=n.id)for(;n;){if("addMission"==n.id)return void(""!=k.className&&(k.className=""));n=n.parentNode,k.className="noClick"}};var b=i[0];function N(e){au.src=e,au.play()}function v(e,n,i,t,s){this.index=e,this.missionName=n,this.workTime=i,this.restTime=t,this.workTime0=i,this.restTime0=t,this.count=s,this.beginTime=new Date("2016/11/11 00:00:00"),this.endTime=new Date("2016/11/11 00:00:00"),this.endTime.setSeconds(i),this.workLeftTime=parseInt((this.endTime.getTime()-this.beginTime.getTime())/1e3),this.endTime.setSeconds(t),this.restLeftTime=parseInt((this.endTime.getTime()-this.beginTime.getTime())/1e3),this.finishCount=0,this.isWorking=!0,this.oSpan1,this.oSpan2,this.oSpan3,this.oSpan4,this.oSpan5,working=!1,SetTime=function(e){if(e.isWorking){if(manualOperation&&e.restLeftTime<0)return e.oSpan2.style.display="none",e.oSpan3.style.display="none",e.oSpan4.style.display="none",e.oSpan6.style.display="none",e.oSpan7.style.display="inline-block",void(e.oSpan7.onclick=function(){working=!0,e.restLeftTime=e.restTime,e.oSpan2.style.display="inline-block",e.oSpan3.style.display="inline-block",e.oSpan4.style.display="none",e.oSpan6.style.display="none",e.oSpan7.style.display="none",SetTime(e)});e.workLeftTime--,e.workLeftTime<0&&(soundRemind&&N(soundMission),clearTimeout(timekeeper),e.finishCount++,e.oSpan1.innerHTML=e.finishCount+"/"+e.count,e.restLeftTime=e.restTime,e.isWorking=!1,manualOperation&&(working=!1),e.oSpan2.style.display="none",e.oSpan3.style.display="none",e.oSpan4.style.display="inline-block")}else{if(manualOperation&&!working)return clearTimeout(timekeeper),e.oSpan2.style.display="none",e.oSpan3.style.display="none",e.oSpan4.style.display="none",e.oSpan6.style.display="inline-block",void(e.oSpan6.onclick=function(){working=!0,e.oSpan2.style.display="inline-block",e.oSpan3.style.display="inline-block",e.oSpan6.style.display="none",SetTime(e)});if(e.restLeftTime--,e.restLeftTime<0){if(soundRemind&&N(soundRest),e.finishCount==e.count)return clearTimeout(timekeeper),e.oSpan2.style.display="none",e.oSpan3.style.display="none",e.oSpan4.style.display="none",e.oSpan5.style.display="inline-block",oH1.innerHTML="专注时刻",void(working=!1);clearTimeout(timekeeper),e.workLeftTime=e.workTime,e.isWorking=!0,e.oSpan2.style.display="inline-block",e.oSpan3.style.display="inline-block",e.oSpan4.style.display="none",manualOperation&&(working=!1),this.oSpan2.getElementsByTagName("i")[0].innerHTML="&#xe602;",this.oSpan2.nextSibling.getElementsByTagName("i")[0].innerHTML="&#xe62e;",this.oSpan2.nextSibling.className="span3"}}e.ShowTime(),console.count(),timekeeper=setTimeout(function(){SetTime(e)},1e3)}}b.getElementsByTagName("div")[0].onclick=function(){""!=k.className&&(k.className="");var e=document.getElementById("li-totalTime"),n=document.getElementById("li-missionTime"),i=document.getElementById("li-restTime"),t=parseInt(clockTime/60)+parseInt(clockSRestTime/60);e.innerHTML=t+"分",n.innerHTML=clockTime/60+"分",i.innerHTML=clockSRestTime/60+"分"},au=document.createElement("audio"),au.preload="auto",v.prototype={constructor:v,GetMissionName:function(){return this.missionName},GetIndex:function(){return this.index},SetWorkTime:function(){this.endTime.setSeconds(this.workTime),this.workLeftTime=parseInt((this.endTime.getTime()-this.beginTime.getTime())/1e3)},SetRestTime:function(){this.endTime.setSeconds(this.restTime),this.restLeftTime=parseInt((this.endTime.getTime()-this.beginTime.getTime())/1e3)},GetCount:function(){return this.count},GetWorkTime:function(){return this.workTime},GetRestTime:function(){return this.restTime},CreateMissionList:function(){var e=document.createElement("ul"),n=document.createElement("li"),i=document.createElement("span");oSpan2=document.createElement("span"),oSpan3=document.createElement("span");var t=document.createElement("span"),s=document.createElement("span"),o=document.createElement("span"),a=document.createElement("span");this.oSpan1=i,this.oSpan2=oSpan2,this.oSpan3=oSpan3,this.oSpan4=t,this.oSpan5=s,this.oSpan6=o,this.oSpan7=a;var l=document.createElement("strong"),m=document.createElement("a"),r=document.createElement("a"),d=document.createElement("a"),c=document.createElement("a"),p=document.createElement("i"),u=document.createElement("i"),h=document.createElement("i"),T=document.createElement("i"),f=document.createElement("i"),y=document.createElement("i"),g=document.createElement("div");i.innerHTML=this.finishCount+"/"+this.count,L.value?l.innerHTML=L.value:l.innerHTML=L.placeholder,p.className="iconfont",u.className="iconfont",h.className="iconfont",T.className="iconfont",f.className="iconfont",y.className="iconfont",p.innerHTML="&#xe609;",u.innerHTML="删除",h.innerHTML="&#xe64b; 休息一下!",T.innerHTML="&#xe602; 任务完成!",f.innerHTML="&#xe64b; 休息一下!",y.innerHTML="&#xe64b; 任务继续!",i.className="span1",oSpan2.className="span2",t.className="span4",s.className="span5",o.className="span6",a.className="span7",m.appendChild(p),r.appendChild(u),d.appendChild(f),c.appendChild(y),oSpan2.appendChild(m),oSpan3.appendChild(r),t.appendChild(h),s.appendChild(T),o.appendChild(d),a.appendChild(c),g.appendChild(i),g.appendChild(oSpan2),g.appendChild(oSpan3),g.appendChild(t),g.appendChild(s),g.appendChild(o),g.appendChild(a),n.appendChild(l),n.appendChild(g),e.appendChild(n),oDivMissionList.appendChild(e),S.innerHTML=1,L.value="",k.className="noClick"},ShowTime:function(){missionWorkTimeM=parseInt(this.workLeftTime/60),missionWorkTimeS=parseInt(this.workLeftTime%60),missionRestTimeM=parseInt(this.restLeftTime/60),missionRestTimeS=parseInt(this.restLeftTime%60),oH1=document.getElementsByTagName("h1")[0],this.isWorking?(missionWorkTimeM<10&&missionWorkTimeM.toString().length<2&&(missionWorkTimeM="0"+missionWorkTimeM),missionWorkTimeS<10&&missionWorkTimeS.toString().length<2&&(missionWorkTimeS="0"+missionWorkTimeS),oH1.innerHTML=missionWorkTimeM+"  :  "+missionWorkTimeS):(missionRestTimeM<10&&missionRestTimeM.toString().length<2&&(missionRestTimeM="0"+missionRestTimeM),missionRestTimeS<10&&missionRestTimeS.toString().length<2&&(missionRestTimeS="0"+missionRestTimeS),oH1.innerHTML=missionRestTimeM+"  :  "+missionRestTimeS),tick&&N(soundTick)},EventStart:function(){var e=this;this.oSpan2.onclick=function(){this.parentNode.parentNode.parentNode;var n="&#x"+escape(this.getElementsByTagName("i")[0].innerHTML).slice(2).toLowerCase()+";";working?(console.log("tick is onclick!!!"),clearTimeout(timekeeper),e.finishCount<e.count?(console.log("finishCount : "+e.finishCount),console.log("count : "+e.count),this.getElementsByTagName("i")[0].innerHTML="&#xe609;",this.nextSibling.getElementsByTagName("i")[0].innerHTML="&#xe636;",this.nextSibling.className="",e.workLeftTime=e.workTime,e.restLeftTime=e.restTime,finishAutoRest?(e.workLeftTime=-1,SetTime(e)):(e.finishCount++,e.oSpan1.innerHTML=e.finishCount+"/"+e.count,e.finishCount==e.count?(soundRemind&&N(soundRest),e.oSpan2.style.display="none",e.oSpan3.style.display="none",e.oSpan4.style.display="none",e.oSpan5.style.display="inline-block",oH1.innerHTML="番茄计时器"):e.ShowTime())):(console.log("完成指定次数任务！！"),e.finishCount++,e.oSpan1.innerHTML=e.finishCount+"/"+e.count,finishAutoRest?(console.log("打开自动休息！！"),e.workLeftTime=-1,SetTime(e)):(console.log("没有打开自动休息！！"),e.oSpan2.style.display="none",e.oSpan3.style.display="none",e.oSpan4.style.display="none",e.oSpan5.style.display="inline-block",oH1.innerHTML="专注时刻")),working=!1):("&#xe609;"==n&&(this.getElementsByTagName("i")[0].innerHTML="完成",SetTime(e)),this.nextSibling.getElementsByTagName("i")[0].innerHTML="&#xe62e;",this.nextSibling.className="span3",working=!0)}},EventStop:function(){var e=this;oSpan3.onclick=function(){var n=this.parentNode.parentNode.parentNode;"&#xe62e;"=="&#x"+escape(this.getElementsByTagName("i")[0].innerHTML).slice(2).toLowerCase()+";"?(this.className="",this.previousSibling.getElementsByTagName("i")[0].innerHTML="&#xe609;",this.getElementsByTagName("i")[0].innerHTML="删除",clearTimeout(timekeeper),e.workLeftTime=e.workTime,e.restLeftTime=e.restTime,working=!1):(oDivMissionList.removeChild(n),0==oDivMissionList.childNodes.length&&(oH1.innerHTML="专注时刻"),clearTimeout(timekeeper),e.workLeftTime=e.workTime,e.restLeftTime=e.restTime)}}};var E=0,w=new Array;M.onclick=function(){g=""==L.value?L.placeholder:L.value,y=parseInt(S.innerHTML),w.push(new v(E,g,clockTime,clockSRestTime,y)),document.getElementById("missionList")||(oDivMissionList=document.createElement("div"),oDivMissionList.id="missionList",b.appendChild(oDivMissionList)),w[E].CreateMissionList(),w[E].ShowTime(),w[E].EventStart(),w[E].EventStop(),E++}};